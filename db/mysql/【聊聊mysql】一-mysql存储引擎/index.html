<!DOCTYPE html>
<html lang="zh-CN">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1.0, user-scalable=no">

    
      <link rel="icon" href="/favicon.png" />
    

    <title>
        
          【聊聊MySQL】一. MySQL存储引擎 - 丹崽的技术博客
        
    </title>

    <!-- Spectre.css framework -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/spectre.css/0.5.9/spectre.min.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/spectre.css/0.5.9/spectre-exp.min.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/spectre.css/0.5.9/spectre-icons.min.css">

    <!-- theme css & js -->
    
<link rel="stylesheet" href="/css/book.css">

    
<script src="/js/book.js"></script>


    <!-- tocbot -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/tocbot/4.4.2/tocbot.min.js"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/tocbot/4.4.2/tocbot.css">
    
    <!-- katex -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.10.0/katex.min.css">

    
    
<script src="https://cdnjs.cloudflare.com/ajax/libs/zooming/2.1.1/zooming.min.js"></script>
<script>
document.addEventListener('DOMContentLoaded', function () {
    const zooming = new Zooming()
    zooming.listen('.book-content img')
})
</script>

    
<script type="text/javascript">
var _hmt = _hmt || [];
(function() {
  var hm = document.createElement("script");
  hm.src = "https://hm.baidu.com/hm.js?66f61662f62178eebb934fa943e5df84";
  var s = document.getElementsByTagName("script")[0];
  s.parentNode.insertBefore(hm, s);
})();
</script>

<meta name="generator" content="Hexo 5.2.0"></head>

<body>

<div class="book-container">
  <div class="book-sidebar">
    <div class="book-brand">
  <a href="/">
    <img src="/favicon.png">
    <span>丹崽的技术博客</span>
  </a>
</div>
    <div id="menu" class="book-menu hide">
  <ul>
<li><a href="/">Home</a></li>
</ul>
<h1 id="计算机碎碎念"><a href="#计算机碎碎念" class="headerlink" title="计算机碎碎念"></a>计算机碎碎念</h1><h2 id="计算机网络"><a href="#计算机网络" class="headerlink" title="计算机网络"></a>计算机网络</h2><ul>
<li><a href="/Computer/Network/1-Find-Computer-Network/">生活中的网络</a></li>
<li><a href="/Computer/Network/2-TCP-IP-PROTOCOL/">TCP/IP之数据链路层</a></li>
<li><a href="/Computer/Network/3-IP/">TCP/IP之网络层IP协议</a></li>
<li><a href="/Computer/Network/4-TCP-UDP/">TCP/IP之传输层TCP/UDP协议</a></li>
</ul>

</div>


<script src="/js/book-menu.js"></script>

  </div>

  <div class="sidebar-toggle" onclick="sidebar_toggle()" onmouseover="add_inner()" onmouseleave="remove_inner()">
  <div class="sidebar-toggle-inner"></div>
</div>

<script>
function add_inner() {
  let inner = document.querySelector('.sidebar-toggle-inner')
  inner.classList.add('show')  
}

function remove_inner() {
  let inner = document.querySelector('.sidebar-toggle-inner')
  inner.classList.remove('show')
}

function sidebar_toggle() {
    let sidebar_toggle = document.querySelector('.sidebar-toggle')
    let sidebar = document.querySelector('.book-sidebar')
    let content = document.querySelector('.off-canvas-content')
    if (sidebar_toggle.classList.contains('extend')) { // show
        sidebar_toggle.classList.remove('extend')
        sidebar.classList.remove('hide')
        content.classList.remove('extend')
    }
    else { // hide
        sidebar_toggle.classList.add('extend')
        sidebar.classList.add('hide')
        content.classList.add('extend')
    }
}
</script>

  <div class="off-canvas-content">
    <div class="columns">
      <div class="column col-10 col-lg-12">
        <div class="book-navbar">
          <!-- For Responsive Layout -->

<header class="navbar">
  <section class="navbar-section">
    <a onclick="open_sidebar()">
      <i class="icon icon-menu"></i>
    </a>
  </section>
</header>

        </div>
        <div class="book-content">
          <div class="book-post">
  <h2 id="一-MySQL介绍"><a href="#一-MySQL介绍" class="headerlink" title="一.MySQL介绍"></a>一.MySQL介绍</h2><p>作为 <code>MySQL</code> 系列的开篇，我觉得还是有必要说说大家熟悉的 <code>MySQL</code> 数据库的一些东西。 <code>MySQL</code> 我想作为开发者应该没有人不认识或者不熟悉了吧。不管所在的厂子是大中小，基本上很多时候都会采用 <code>MySQL</code> 作为我们数据的存储介质。当然政府项目很多都会采用 <code>Oracle</code> 数据库，不过最近看来，这个事情貌似也不是绝对。也有很多政府的项目已经决定采用 <code>MySQL</code> 或者其他厂商封装的 <code>MySQL</code> 分支了。 作为数据库，其实定义是这样的：</p>
<ul>
<li>数据库：文件或者其他文件类型的集合，在 <code>MySQL</code> 中，文件被存储为 <code>frm</code> <code>myd</code> <code>ibd</code> 等多种形式的文件。而有些存储引擎比如 <code>NDB</code> 他的数据信息则是被存储在内存之中的，并不会持久化到硬盘上面，所以他不需要文件来进行存储。速度稍稍快但数据库出现异常重启的话，数据就会丢失。</li>
<li>数据库实例或软件：其实就是运行的，可以读取以上数据库文件的软件进程，他可能是一个也可能是多个，日常开发经常是运行一个的情形。我们运行 <code>SQL</code> 或者其他操作的，其实都是在跟数据库实例进行交互，数据库实例会根据命令，计算出来比较高效的查询策略在硬盘上进行数据查询。</li>
</ul>
<h2 id="二-MySQL体系结构"><a href="#二-MySQL体系结构" class="headerlink" title="二.MySQL体系结构"></a>二.MySQL体系结构</h2><p>558</p>
<p> 数据库由上面几大部分组成，每一部分基本上所做的事情都非常多，而且对数据操作过程中都起着非常重要的作用。<code>MySQL</code> 还有个特点就是存储引擎采用插件式的方式，只要我们按照 <code>MySQL</code> 规范去开发引擎，即可引入数据库软件然后进行启动存储。引擎不是存储数据的地方，而是定义怎么存储数据的地方。而且存储引擎的细粒度是表，也就是说我们新建一个数据库（database），可以使用多个存储引擎来建表。</p>
<h2 id="三-MySQL存储引擎"><a href="#三-MySQL存储引擎" class="headerlink" title="三.MySQL存储引擎"></a>三.MySQL存储引擎</h2><p>由于我们经常使用的无非就是 <code>InnoDB</code> 和 <code>MyISAM</code> 两种引擎，所以其他的我并不打算细讲，稍微带过去就可以了。</p>
<h3 id="1-InnoDB"><a href="#1-InnoDB" class="headerlink" title="1.InnoDB"></a>1.InnoDB</h3><p><code>InnoDB</code> 支持数据库事务（<code>SQL</code> 要么一起成功要么一起失败）现在 <code>MySQL</code> 版本默认的存储引擎，支持行级锁，支持外键，以及支持非锁定读（读取不会产生锁）。 通过多版本并发控制 <code>MVCC</code> 来获得高并发性，并且实现 <code>SQL</code> 标准的 <code>4</code> 种隔离机制，默认隔离机制是 <code>REPEATABLE</code>，同时使用一种 <code>next-key locking</code> 策略（简单说就是版本控制）来避免幻读的产生。 说到这得回忆一下 <code>MySQL</code> 的四种隔离级别：</p>
<p>隔离级别</p>
<p>说明</p>
<p><code>Serializable</code></p>
<p>最严格的级别，有事务一个一个来，最慢也最安全</p>
<p><code>REPEATABLE READ</code></p>
<p>避免修改另外一个事务读取但未修改的数据，但不能避免幻读</p>
<p><code>READ COMMITTED</code></p>
<p>大多数数据库采用的级别，避免脏读但不避免幻读和不可重复读</p>
<p><code>Read Uncommitted</code></p>
<p>事务会读取到另外一个事物已修改但未提交的数据</p>
<blockquote>
<ul>
<li>脏读：读取到了其他事务已修改但未提交的数据，如A读取到了B事务修改后的数据X，但是B事务进行了回滚，这时候说明A事务产生了脏读。</li>
<li>不可重复读：事务A读取一条数据，后面B事务修改了这条数据，A再次读取时发现数据不匹配，这就是不可重复读</li>
<li>幻读：事务A根据某个条件读取N条数据，事务B改变了其他数据使之满足A的搜索条件，事务再次读取发现有大于N条的数据</li>
</ul>
</blockquote>
<p><code>InnoDB</code> 存数数据的时候是按照主键（如果没有设置主键，<code>InnoDB</code> 会偷偷的给一个主键）的顺序进行存储，形成 <code>B+</code> 树结构，根据其他索引查询的时候需要回表，即回到最原始的这棵树进行匹配再返回所有数据。</p>
<h3 id="2-MyISAM"><a href="#2-MyISAM" class="headerlink" title="2.MyISAM"></a>2.MyISAM</h3><p><code>InnoDB</code> 支持的事务、表锁他都不支持，也不支持全文索引。由 <code>MYD</code> 和 <code>MYI</code> 文件共同协助。前者存储数据后者存储索引。支持全文索引。</p>
<h3 id="3-NDB"><a href="#3-NDB" class="headerlink" title="3.NDB"></a>3.NDB</h3><p>集群存储引擎，<code>NDB</code> 是将数据全部放置于内存中（<code>5.1</code> 之后可以将非索引数据放置于硬盘），因此主键查找很快，也可以新增节点提高性能。但是连接操作是在 <code>MySQL</code> 数据库层，并非引擎完成（其实就是说连接的时候不能真正的连接而是需要一个一个查询连接）效率较低。</p>
<h3 id="4-Memory"><a href="#4-Memory" class="headerlink" title="4.Memory"></a>4.Memory</h3><p>也是数据存储于内存的引擎，使用哈希索引进行查询。但有些限制：不支持 <code>VARCHAR</code> 使用 <code>CHAR</code> 的形式进行存储，也不支持大文本数据。临时表会使用该引擎进行查询，但是如果临时表有大文本或者超过容量设置，就会降级至 <code>MyISAM</code> 进行存储到硬盘，由于 <code>MyISAM</code> 不支持缓存数据文件，因此此时临时表可能会拖慢查询速度。</p>
<h3 id="5-Archive"><a href="#5-Archive" class="headerlink" title="5.Archive"></a>5.Archive</h3><p>只支持 <code>INSERT</code> 和 <code>SELECT</code> 的引擎，对数据进行压缩，压缩比高，适合存储归档数据如日志信息等。其目的是压缩。</p>
<h3 id="6-Federated"><a href="#6-Federated" class="headerlink" title="6.Federated"></a>6.Federated</h3><p>不存放数据的引擎，指向一台远程的 <code>MySQL</code> 数据库服务器的表。</p>
<h3 id="7-Maria"><a href="#7-Maria" class="headerlink" title="7.Maria"></a>7.Maria</h3><p><code>MyISAM</code> 的后续版本，支持缓存数据和索引文件，行级锁设计、提供 <code>MVCC</code> 功能，支持事务，以及更好的 <code>BLOB</code> 字符类型的处理性能。 <code>MySQL</code> 支持哪些存储引擎可以通过语句 <code>SHOW ENGINES\G</code> 来查看。 </p>
<p>2337</p>
<h2 id="四-连接MySQL"><a href="#四-连接MySQL" class="headerlink" title="四.连接MySQL"></a>四.连接MySQL</h2><h3 id="TCP-IP"><a href="#TCP-IP" class="headerlink" title="TCP/IP"></a>TCP/IP</h3><p>可以说最常见的连接方式了，使用 <code>IP</code> <code>用户名</code> <code>密码</code> 进行连接基本是我们调试，生产一直使用的方式。请求连接时 <code>MySQL</code> 数据库实例会判断当前用户是否拥有权限进行连接，一般来说，会限制用户只能从哪个 <code>IP</code> 进行连接。</p>
<h3 id="命令管道和共享内存"><a href="#命令管道和共享内存" class="headerlink" title="命令管道和共享内存"></a>命令管道和共享内存</h3><p>在 <code>Windows</code> 系列上，如果客户端和服务端同属于一台服务器上，那么可以通过配置文件配置 <code>--enable-named-pipe</code> 选项开启命令管道，当然这些方法都不常用，不细说。</p>
<h3 id="UNIX管道"><a href="#UNIX管道" class="headerlink" title="UNIX管道"></a>UNIX管道</h3><p>首先使用 <code>TCP/IP</code> 进行数据库连接，运行 <code>SHOW VARIABLES LIKE &#39;socket&#39;</code> 命令查看 <code>Socket</code> 管道所在的位置，然后我们就可以通过 <code>mysql -uroot -S /tmp/mysql.sock</code> 从而使用 <code>UNIX管道</code> 的方式进行数据库连接。</p>
<h2 id="五-总结"><a href="#五-总结" class="headerlink" title="五.总结"></a>五.总结</h2><p>了解 <code>MySQL</code> 术语； 了解 <code>MySQL</code> 体系架构； 了解 <code>MySQL</code> 支持的引擎系列； 了解 <code>MySQL</code> 的连接方式。</p>

</div>




<script src="/js/book-post.js"></script>

        </div>
      </div>
      <div class="column col-2 hide-lg">
        <div class="book-post-info">
  
    <div class="book-post-meta">

  <div class="author">

    <!-- Author image -->
    <div class="author-img">
      
        <figure
          class="avatar avatar-lg"
          data-initial="W"
          style="background-color: #3b4351;">
        </figure>
      
    </div>

    <!-- Author title -->
    <div class="author-title">
      <div>Weidan</div>
      <div>2019-09-05</div>
    </div>
  </div>

  
    <div class="divider"></div>

    <div class="link">
      <a class="category-link" href="/categories/db/">db</a> <a class="category-link" href="/categories/db/mysql/">mysql</a>

      <a class="tag-none-link" href="/tags/InnoDB/" rel="tag">#InnoDB</a> <a class="tag-none-link" href="/tags/mysql/" rel="tag">#mysql</a>
    </div>
    
  

  <div class="divider"></div>
</div>
  

  <div class="book-tocbot">
</div>
<div class="book-tocbot-menu">
  <a class="book-toc-expand" onclick="expand_toc()">Expand all</a>
  <a onclick="go_top()">Back to top</a>
  <a onclick="go_bottom()">Go to bottom</a>
</div>


<script src="/js/book-toc.js"></script>

</div>
      </div>
    </div>
  </div>
  
  <a class="off-canvas-overlay" onclick="hide_canvas()"></a>
</div>

</body>
</html>


<script src="/js/book.js"></script>
